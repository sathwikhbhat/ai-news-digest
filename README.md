# AI News Digest    

## Overview

AI News Digest is a Spring Boot-based RESTful API that fetches the latest news headlines from NewsAPI.org and provides AI-powered summaries using Google's Gemini API. The application offers both JSON text summaries and HTML-formatted responses (generated directly by Gemini) with intelligent caching for optimal performance.

## Features

- **Real-time News Fetching**: Integrates with NewsAPI.org to retrieve the latest US headlines
- **AI-Powered Summarization**: Uses Google Gemini AI to create concise, informative news summaries
- **Multiple Output Formats**: Supports both JSON text summaries and HTML-formatted pages (HTML generated by Gemini AI)
- **Intelligent Caching**: Implements Spring Cache to reduce API calls and improve response times
- **RESTful Architecture**: Clean, well-structured API endpoints following REST principles

## Tech Stack

- **Framework**: Spring Boot 3.5.6
- **Language**: Java 21
- **Build Tool**: Maven
- **External APIs**:
  - NewsAPI.org (news data)
  - Google Gemini API (AI summarization)
- **Caching**: Spring Cache with ConcurrentMapCacheManager
- **HTTP Client**: Spring RestClient

## Project Architecture

The application follows a layered architecture pattern:

```
┌─────────────────┐
│   Controller    │ ← REST endpoints
├─────────────────┤
│    Service      │ ← Business logic
├─────────────────┤
│     Client      │ ← External API integration
├─────────────────┤
│      DTO        │ ← Data transfer objects
└─────────────────┘
```

### Core Components

- **Controllers**: Handle HTTP requests and responses
- **Services**: Implement business logic and orchestrate operations
- **Clients**: Manage external API communications
- **DTOs**: Define data structures for API interactions
- **Configuration**: Setup for REST clients and caching

## API Endpoints

### 1. Get News Summary (JSON)
```http
GET /api/v1/news/summary
```
**Response**: JSON string containing AI-summarized news digest
**Content-Type**: `application/json`

### 2. Render News Digest (HTML)
```http
GET /api/v1/news/render
```
**Response**: Complete HTML page with styled news summary (generated by Gemini AI)
**Content-Type**: `text/html`

### 3. Clear Cache
```http
DELETE /api/v1/news/cache
```
**Response**: Confirmation message
**Purpose**: Clears all cached responses to force fresh data retrieval

## Workflow

<p align="center">
  <img src="https://github.com/user-attachments/assets/0e4e43f8-d4ac-4630-8020-7d8939bb48bf" alt="News Rendering Pipeline with Gemini Summarization" width="60%"/>
</p>

The application follows this workflow:

1. **Client Request**: User makes an HTTP request to one of the API endpoints
2. **Cache Check**: Spring Cache checks if the response is already cached
3. **News Fetching**: If not cached, NewsClient fetches the latest headlines from NewsAPI.org
4. **AI Processing**: GeminiService sends news data to the Google Gemini API for summarization (with format specification for JSON or HTML)
5. **Response Formatting**: Gemini AI generates the response in the requested format (either JSON text or HTML)
6. **Caching**: Response is cached for future requests
7. **Client Response**: Gemini-generated response is returned to the client


## Getting Started

### Prerequisites

- Java 21 or higher
- Maven 3.6+
- [NewsAPI.org API key](https://newsapi.org/)
- [Google Gemini API key](https://ai.google.dev/) 

### Installation & Setup

1. **Clone the repository**
   ```bash
   git clone https://github.com/sathwikhbhat/ai-news-digest.git
   cd ai-news-digest
   ```

2. **Set up environment variables**
   ```properties
   NEWS_API_KEY=your_newsapi_key_here
   GEMINI_API_KEY=your_gemini_api_key_here
   ```

3. **Build the project**
   ```bash
   ./mvnw clean install
   ```

4. **Run the application**
   ```bash
   ./mvnw spring-boot:run
   ```

5. **Access the application**
   - News Summary JSON: `http://localhost:8080/api/v1/news/summary`
   - News Summary HTML: `http://localhost:8080/api/v1/news/render`

## Usage Examples

### Get JSON Summary
```bash
curl -X GET http://localhost:8080/api/v1/news/summary
```

### Get HTML Rendered Page
```bash
curl -X GET http://localhost:8080/api/v1/news/render
```

### Clear Cache
```bash
curl -X DELETE http://localhost:8080/api/v1/news/cache
```

## Caching Strategy

The application implements a two-tier caching system:

- **News API Cache**: Caches raw news data from NewsAPI.org (`topHeadlines`)
- **Gemini Response Cache**: Caches AI-generated summaries (`geminiResponse`)

Cache keys are generated based on:
- News content hash
- Rendering mode (JSON vs HTML)

This ensures that identical news content returns cached responses while different content or formats trigger new API calls.

## Project Structure

```
src/
├── main/
│   ├── java/com/sathwikhbhat/ai_news_digest/
│   │   ├── AiNewsDigestApplication.java          # Main application class
│   │   ├── client/                               # External API clients
│   │   │   ├── GeminiClient.java                 # Gemini API integration
│   │   │   └── NewsClient.java                   # NewsAPI integration
│   │   ├── config/                               # Configuration classes
│   │   │   ├── CacheConfig.java                  # Cache configuration
│   │   │   └── RestClientConfig.java             # REST client setup
│   │   ├── controller/                           # REST controllers
│   │   │   └── NewsController.java               # News API endpoints
│   │   ├── dto/                                  # Data transfer objects
│   │   │   ├── GeminiApiBody.java                # Gemini request DTO
│   │   │   ├── GeminiApiResponse.java            # Gemini response DTO
│   │   │   └── NewsApiResponse.java              # NewsAPI response DTO
│   │   └── service/                              # Business logic
│   │       ├── GeminiService.java                # Gemini integration service
│   │       └── NewsService.java                  # News orchestration service
│   └── resources/
│       └── application.properties                # Application configuration
└── test/                                         # Test classes
```

## Error Handling

The application includes comprehensive error handling:

- **API Rate Limits**: Caching reduces API calls to stay within limits
- **Network Failures**: Graceful handling of external API failures
- **Invalid Responses**: Validation of API response structures
- **Configuration Errors**: Clear error messages for missing API keys